(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{5301:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return n(9391)}])},9391:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return H}});var r=n(5893),i=n(9008),a=n(7294),o=n(1510),l=n(944),c=function(){var e=(0,a.useState)(),t=e[0],n=e[1];return(0,a.useEffect)((function(){n(new Date);var e=setInterval((function(){n(new Date)}),1e3);return function(){clearInterval(e)}}),[]),(0,r.jsx)("p",{className:"text-sm hidden lg:block",children:t&&(0,o.Z)(t,"M\u6708d\u65e5(eee) HH\u6642mm\u5206ss\u79d2",{locale:l.Z})})},s=n(7536),u=n(9218),d=n(6096),f=n(8386),m=n(6159),x=n(5071),p="\u3082\u304f\u3082\u304f\u4f1a\u03b2",h="\u4ed5\u4e8b\u3084\u52c9\u5f37\u306b\u3082\u304f\u3082\u304f\u3068\u53d6\u308a\u7d44\u3080\u4f1a",b=n(5690),v=function(){(0,m.XB)(x.I8).then((function(){b.ZP.success("\u300c".concat(p,"\u300d\u3078\u3088\u3046\u3053\u305d\uff01"),{icon:"\ud83d\udc4b\ud83c\udffb"})}))},j=function(){(0,m.w7)(x.I8)},y=n(4051),g=n.n(y),w=n(1294);n(8100);function N(e,t,n,r,i,a,o){try{var l=e[a](o),c=l.value}catch(s){return void n(s)}l.done?t(c):Promise.resolve(c).then(r,i)}function O(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function o(e){N(a,r,i,o,l,"next",e)}function l(e){N(a,r,i,o,l,"throw",e)}o(void 0)}))}}function k(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function S(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){k(e,t,n[t])}))}return e}(function(){var e=O(g().mark((function e(t,n){var r,i;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=(0,w.JU)((0,w.hJ)(x.db,"rooms")),i=S({},t,{rid:r.id,createdAt:Date.now(),users:[n.id]}),e.next=4,(0,w.pl)(r,S({},i,{rid:r.id,createdAt:Date.now()}));case 4:return e.abrupt("return",r.id);case 5:case"end":return e.stop()}}),e)})))})(),function(){var e=O(g().mark((function e(t){var n,r;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=(0,w.JU)(x.db,"rooms/".concat(t)),e.next=3,(0,w.QT)(n);case 3:return r=e.sent.data,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)})))}();var C=function(){var e=O(g().mark((function e(t,n){var r,i;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=(0,w.hJ)(x.db,"rooms/".concat(t,"/messages")),i=S({},n,{createdAt:Date.now()}),e.abrupt("return",(0,w.ET)(r,i));case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();function P(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function E(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){P(e,t,n[t])}))}return e}function V(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var _=function(e){var t=e.isVisible,n=(0,s.cI)({mode:"onChange"}),i=n.handleSubmit,o=n.register,l=n.reset,c=n.getValues,m=n.formState.isValid,x=o("body",{required:!0}),p=x.ref,h=V(x,["ref"]),b=(0,f.a)(),j=(0,a.useRef)();if((0,u.y1)("f",(function(e){var t;null===(t=j.current)||void 0===t||t.focus(),e.preventDefault()})),(0,a.useEffect)((function(){var e;j.current&&(null===(e=j.current)||void 0===e||e.focus())}),[t]),void 0===b)return null;if(null===b)return(0,r.jsxs)("p",{className:"mb-6",children:[(0,r.jsx)("button",{onClick:v,className:"text-pink-600",children:"\u533f\u540d\u3067\u53c2\u52a0"}),"\u3057\u3066\u30b3\u30e1\u30f3\u30c8\u3059\u308b"]});var y=function(e){C("global",{name:b.name,emoji:b.emoji,body:e.body}),l()};return(0,r.jsxs)("form",{className:"mb-1 text-right",onSubmit:i(y),children:[(0,r.jsx)(d.Z,E({onKeyDown:function(e){e.metaKey&&"Enter"===e.key&&m&&y(c())},placeholder:"\u610f\u6c17\u8fbc\u307f\u306a\u3069",autoFocus:!0,className:"bg-transparent w-full resize-none rounded"},h,{ref:function(e){p(e),j.current=e}})),(0,r.jsxs)("button",{disabled:!m,className:"text-sm disabled:opacity-40 disabled:text-white text-green-400 text-glow",type:"submit",children:[(0,r.jsx)("span",{className:"emoji",children:"\u23ce"}),"(Cmd + Enter)"]})]})},D=n(6422),I=n(8616),T=n(3731);function F(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Z=function(){var e=(0,a.useState)(),t=e[0],n=e[1];return(0,a.useEffect)((function(){return(0,w.cf)(function(e){var t=(0,w.hJ)(x.db,"rooms/".concat(e,"/messages"));return(0,w.IO)(t,(0,w.Xo)("createdAt","desc"))}("global"),(function(e){var t=e.docs.map((function(e){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){F(e,t,n[t])}))}return e}({id:e.id},e.data())}));n(t)}))}),[]),void 0===t?null:(0,r.jsx)("div",{className:"flex-1 overflow-auto",children:(null===t||void 0===t?void 0:t.length)?(0,r.jsx)("ul",{className:"space-y-4",children:null===t||void 0===t?void 0:t.map((function(e){return(0,r.jsxs)("li",{children:[(0,r.jsx)("p",{className:"break-words",children:(0,r.jsx)(T.Z,{children:e.body})}),e.emoji&&e.name&&(0,r.jsxs)("p",{className:"flex mt-1 items-center space-x-1 flex-wrap text-xs opacity-60",children:[(0,r.jsx)(I.dy,{native:!0,size:16,emoji:e.emoji}),(0,r.jsx)("span",{children:e.name}),(0,r.jsx)("span",{children:(0,D.Z)(e.createdAt,{addSuffix:!0,locale:l.Z})})]})]},e.id)}))}):(0,r.jsx)("p",{children:"Empty...\ud83d\ude34"})})},q=(n(7898),n(162)),z=n(6727);function A(e){var t=e.isOpen,n=e.onClose,i=e.title,o=e.children;return(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(z.uT,{appear:!0,show:t,as:a.Fragment,children:(0,r.jsx)(z.Vq,{as:"div",className:"fixed inset-0 z-10 overflow-y-auto",onClose:n,children:(0,r.jsxs)("div",{className:"min-h-screen px-4 text-center",children:[(0,r.jsx)(z.uT.Child,{as:a.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:(0,r.jsx)(z.Vq.Overlay,{className:"fixed inset-0"})}),(0,r.jsx)("span",{className:"inline-block h-screen align-middle","aria-hidden":"true",children:"\u200b"}),(0,r.jsx)(z.uT.Child,{as:a.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:(0,r.jsxs)("div",{className:"text-white inline-block w-full max-w-md p-6 my-8 overflow-hidden text-left align-middle transition-all transform bg-black shadow-xl rounded-2xl",children:[(0,r.jsx)(z.Vq.Title,{as:"h3",className:"text-lg leading-6 text-center mb-6 font-bold",children:i}),o]})})]})})})})}function J(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function R(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){J(e,t,n[t])}))}return e}var X=function(){var e=(0,a.useState)(!1),t=e[0],n=e[1],i=(0,a.useState)(!1),o=i[0],l=i[1],c=(0,f.a)(),u=(0,s.cI)(),d=u.handleSubmit,m=u.register,x=u.watch,p=u.control,h=u.formState.isValid;if(!c)return null;return(0,r.jsxs)("div",{children:[(0,r.jsx)("button",{title:"\u30d7\u30ed\u30d5\u30a3\u30fc\u30eb\u7de8\u96c6",className:"px-2",onClick:function(){return n(!0)},children:"\ud83d\udc64"}),(0,r.jsxs)(A,{title:"\u30d7\u30ed\u30d5\u30a3\u30fc\u30eb",isOpen:t,onClose:function(){return n(!1)},children:[(0,r.jsx)("div",{className:"mb-6",children:(0,r.jsxs)("form",{onSubmit:d((function(e){(0,q.Nq)(c.id,e)})),className:"flex gap-4",children:[(0,r.jsx)("button",{type:"button",onClick:function(){return l((function(e){return!e}))},className:"w-14 h-14 border-gray-800 border-2 grid place-content-center rounded-lg",children:(0,r.jsx)(I.dy,{size:32,emoji:x("emoji")||c.emoji})}),(0,r.jsx)("input",R({type:"text",autoComplete:"off",className:"flex-1 min-w-0 bg-transparent rounded border-gray-800 border-2",defaultValue:c.name},m("name",{required:!0}))),(0,r.jsx)("button",{disabled:!h,children:"\u66f4\u65b0"})]})}),o&&(0,r.jsx)("div",{children:(0,r.jsx)(s.Qr,{name:"emoji",control:p,render:function(e){return(0,r.jsx)(I.cW,{theme:"dark",title:"\u30a2\u30a4\u30b3\u30f3\u3092\u9078\u3076",emoji:"point_up",onSelect:function(t){return e.field.onChange(t.id)}})}})}),(0,r.jsxs)("div",{className:"flex items-center justify-between mt-6",children:[(0,r.jsx)("button",{onClick:function(){return n(!1)},children:"\u9589\u3058\u308b"}),(0,r.jsx)("button",{className:"text-sm text-gray-700 ml-auto block",onClick:j,children:"\u30ed\u30b0\u30a2\u30a6\u30c8"})]})]})]})},B=function(e){var t,n,i,a,o,l=e.playerState,c=e.target,s=function(){null===c||void 0===c||c.playVideo()},d=function(){null===c||void 0===c||c.pauseVideo()},f=function(){null===c||void 0===c||c.previousVideo()},m=function(){null===c||void 0===c||c.nextVideo()};return(0,u.y1)("right",m),(0,u.y1)("left",f),(0,u.y1)("space",(function(){1===(null===c||void 0===c?void 0:c.getPlayerState())?d():s()})),(0,r.jsxs)("div",{className:"flex items-center space-x-1 py-2",children:[1!==l&&(0,r.jsx)("button",{className:"flex py-2 px-1 text-2xl emoji",onClick:s,children:"\u25b6\ufe0e"}),1===l&&(0,r.jsx)("button",{className:"flex py-2 px-1 emoji text-2xl",onClick:d,children:"\u23f8"}),(0,r.jsx)("button",{className:"flex py-2 px-1 emoji text-2xl",onClick:f,children:"\u23ea"}),(0,r.jsx)("button",{className:"flex py-2 px-1 emoji text-2xl",onClick:m,children:"\u23e9"}),c&&(0,r.jsxs)("a",{className:"pl-2 flex-1",href:null===(t=c.playerInfo)||void 0===t?void 0:t.videoUrl,rel:"noreferrer",target:"_blank",children:[(0,r.jsx)("h2",{className:"font-bold truncate",children:null===(n=c.playerInfo)||void 0===n||null===(i=n.videoData)||void 0===i?void 0:i.title}),(0,r.jsx)("p",{className:"text-sm truncate",children:null===(a=c.playerInfo)||void 0===a||null===(o=a.videoData)||void 0===o?void 0:o.author})]})]})},K=n(5406),Q=function(e){var t=e.onReady,n=e.onStateChange;return(0,r.jsxs)("div",{className:"fixed inset-0 w-full h-full flex items-center justify-items-center bg-black",children:[(0,r.jsx)(K.Z,{opts:{height:"390",width:"640",playerVars:{listType:"playlist",list:"PL0DVChfFgSa85wVKWF-r55_5005wRuQ4-",autoplay:1,controls:0,disablekb:1,fs:0,iv_load_policy:3,loop:1,modestbranding:1,rel:0}},onReady:function(e){t(e),e.target.setShuffle(!0),e.target.nextVideo()},className:"youtube-space",onStateChange:n}),(0,r.jsx)("div",{className:"youtube-vintage fixed inset-0"}),(0,r.jsx)("div",{className:"noise"})]})},U=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.filter(Boolean).join(" ")},H=function(){var e=(0,a.useState)(),t=e[0],n=e[1],o=(0,a.useState)(!0),l=o[0],s=o[1],u=(0,a.useState)(),d=u[0],m=u[1],x=(0,f.a)();(0,a.useEffect)((function(){var e=Boolean(localStorage.getItem("chatClose"));s(!e)}),[]);return(0,r.jsxs)("div",{children:[(0,r.jsxs)(i.default,{children:[(0,r.jsx)("title",{children:p}),(0,r.jsx)("meta",{name:"description",content:h})]}),(0,r.jsxs)("main",{className:"relative",children:[(0,r.jsx)(Q,{onReady:function(e){n(e.target)},onStateChange:function(e){var t=e.data;m(t)}}),(0,r.jsxs)("div",{className:"flex flex-col fixed inset-0 z-10",children:[(0,r.jsxs)("header",{className:"py-4 px-6 bg-black text-white flex items-center gap-2",children:[(0,r.jsx)("h1",{children:p}),(0,r.jsx)("span",{className:"flex-1"}),(0,r.jsx)("button",{title:"\u30c1\u30e3\u30c3\u30c8\u3092".concat(l?"\u975e\u8868\u793a":"\u8868\u793a"),className:U("px-2",!l&&"opacity-40"),onClick:function(){s((function(e){var t=!e;return t?localStorage.removeItem("chatClose"):localStorage.setItem("chatClose","true"),t}))},children:"\ud83d\udcac"}),x?(0,r.jsx)(X,{}):(0,r.jsx)("button",{onClick:v,children:"\u53c2\u52a0"}),(0,r.jsx)("a",{href:"https://github.com/dninomiya/lofi/wiki",target:"_blank",rel:"noreferrer",className:"px-2",title:"\u3053\u306e\u30b5\u30a4\u30c8\u306b\u3064\u3044\u3066",children:"\u2139\ufe0f"}),(0,r.jsx)(c,{})]}),(0,r.jsxs)("main",{className:"flex-1 grid grid-cols-1 lg:grid-cols-3 overflow-hidden",children:[(0,r.jsx)("div",{className:"py-4 px-6 col-span-2 lg:block hidden",onClick:function(){return null===t||void 0===t?void 0:t.playVideo()}}),(0,r.jsx)("div",{className:U("col-span-1 p-4 h-full overflow-hidden",!l&&"hidden"),children:(0,r.jsxs)("div",{className:"rounded-md bg-black bg-opacity-30 p-4 lg:p-6 text-white flex flex-col h-full",children:[(0,r.jsx)(_,{isVisible:l}),(0,r.jsx)(Z,{})]})})]}),(0,r.jsx)("footer",{className:"flex px-6 items-center bg-black z-10 text-white justify-between",children:t?(0,r.jsx)(B,{playerState:d,target:t}):(0,r.jsx)("div",{})})]})]})]})}}},function(e){e.O(0,[229,213,774,888,179],(function(){return t=5301,e(e.s=t);var t}));var t=e.O();_N_E=t}]);